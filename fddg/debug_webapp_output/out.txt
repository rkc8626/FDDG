Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders
Created 4 evaluation loaders
Traceback (most recent call last):
  File "debug_webapp_training.py", line 269, in <module>
    debug_webapp_training(args)
  File "debug_webapp_training.py", line 209, in debug_webapp_training
    training_manager = train_main(args)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 641, in main
    print("Evaluation loader datasets sizes:", [len(loader.dataset) for loader in eval_loaders])
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 641, in <listcomp>
    print("Evaluation loader datasets sizes:", [len(loader.dataset) for loader in eval_loaders])
AttributeError: 'FastDataLoader' object has no attribute 'dataset'
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/popen_fork.py", line 27, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 553870) is killed by signal: Terminated. 
Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders
Created 4 evaluation loaders
Traceback (most recent call last):
  File "debug_webapp_training.py", line 279, in <module>
    debug_webapp_training(args)
  File "debug_webapp_training.py", line 219, in debug_webapp_training
    training_manager = train_main(args)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 641, in main
    print("Evaluation loader datasets sizes:", [len(loader._dataset) if hasattr(loader, '_dataset') else len(loader.dataset) for loader in eval_loaders])
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 641, in <listcomp>
    print("Evaluation loader datasets sizes:", [len(loader._dataset) if hasattr(loader, '_dataset') else len(loader.dataset) for loader in eval_loaders])
AttributeError: 'FastDataLoader' object has no attribute 'dataset'
Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders

Evaluation loader names: ['env0_in', 'env1_in', 'env0_out', 'env1_out']
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard

Starting webapp training loop simulation...
Will evaluate every None steps
==================================================
Starting training thread...
[2025-04-27 18:32:22] 
Starting training loop...
[2025-04-27 18:32:22] ==================================================
[2025-04-27 18:32:22] Total steps per epoch: 131.22727272727272
[2025-04-27 18:32:22] Target epochs: Not specified
[2025-04-27 18:32:22] ==================================================

Metrics Update:
------------------------------
------------------------------
[2025-04-27 18:32:41] 
Step 500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0101
l_cls               : 0.0101
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>
Exception in thread Thread-5:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 379, in webapp_training_loop
    results = self.evaluate()
  File "debug_webapp_training.py", line 89, in evaluate
    print(f"Dataset type: {type(loader._dataset) if hasattr(loader, '_dataset') else type(loader.dataset)}")
AttributeError: 'FastDataLoader' object has no attribute 'dataset'

Keyboard interrupt received. Stopping training...

Shutting down training manager...
Shutting down training manager...

Training simulation completed!
==================================================
Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders

Evaluation loader names: ['env0_in', 'env1_in', 'env0_out', 'env1_out']
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard

Starting webapp training loop simulation...
Will evaluate every None steps
==================================================
Starting training thread...
[2025-04-27 18:33:24] 
Starting training loop...
[2025-04-27 18:33:24] ==================================================
[2025-04-27 18:33:24] Total steps per epoch: 131.22727272727272
[2025-04-27 18:33:24] Target epochs: Not specified
[2025-04-27 18:33:24] ==================================================

Metrics Update:
------------------------------
------------------------------
[2025-04-27 18:33:47] 
Step 500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0101
l_cls               : 0.0101
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>
Exception in thread Thread-5:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 379, in webapp_training_loop
    results = self.evaluate()
  File "debug_webapp_training.py", line 91, in evaluate
    print(f"Batch size: {loader.batch_size}")
AttributeError: 'FastDataLoader' object has no attribute 'batch_size'

Keyboard interrupt received. Stopping training...

Shutting down training manager...
Shutting down training manager...

Training simulation completed!
==================================================
Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders

Evaluation loader names: ['env0_in', 'env1_in', 'env0_out', 'env1_out']
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard

Starting webapp training loop simulation...
Will evaluate every None steps
==================================================
Starting training thread...
[2025-04-27 18:42:24] 
Starting training loop...
[2025-04-27 18:42:24] ==================================================
[2025-04-27 18:42:24] Total steps per epoch: 131.22727272727272
[2025-04-27 18:42:24] Target epochs: Not specified
[2025-04-27 18:42:24] ==================================================

Metrics Update:
------------------------------
------------------------------
[2025-04-27 18:42:44] 
Step 500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0101
l_cls               : 0.0101
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:43:01] 
Evaluation at step 501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0397 (mean)
loss                : 0.1103 (mean)
l_cls               : 0.1103 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 382.66 MB
Final allocation   : 383.24 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 500.0000
epoch               : 3.8102
step_time           : 0.0397
loss                : 0.1103
l_cls               : 0.1103
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.039658896446228026, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.039658896446228026, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 500, 'value': 0.11032169118573074}
l_cls: {'step': 500, 'value': 0.11032169118573074}
step: {'step': 500, 'value': 500}
epoch: {'step': 500, 'value': 3.810183581572567}
step_time: {'step': 500, 'value': 0.039658896446228026}
env0_in_acc: {'step': 500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 500, 'value': 0.0}
env0_in_demographic_parity: {'step': 500, 'value': 0}
env0_in_equalized_odds: {'step': 500, 'value': 0}
env0_in_auc_score: {'step': 500, 'value': 0.5}
env1_in_acc: {'step': 500, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 500, 'value': 0.0}
env1_in_demographic_parity: {'step': 500, 'value': 0}
env1_in_equalized_odds: {'step': 500, 'value': 0}
env1_in_auc_score: {'step': 500, 'value': 0.5}
env0_out_acc: {'step': 500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 500, 'value': 0.0}
env0_out_demographic_parity: {'step': 500, 'value': 0}
env0_out_equalized_odds: {'step': 500, 'value': 0}
env0_out_auc_score: {'step': 500, 'value': 0.5}
env1_out_acc: {'step': 500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 500, 'value': 0.0}
env1_out_demographic_parity: {'step': 500, 'value': 0}
env1_out_equalized_odds: {'step': 500, 'value': 0}
env1_out_auc_score: {'step': 500, 'value': 0.5}
------------------------------
[2025-04-27 18:43:17] 
Step 1000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1904
l_cls               : 0.1904
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:43:28] 
Evaluation at step 1001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0978 (mean)
l_cls               : 0.0978 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.41 MB
Final allocation   : 380.99 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1000.0000
epoch               : 7.6204
step_time           : 0.0311
loss                : 0.0978
l_cls               : 0.0978
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.03112736940383911, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.03112736940383911, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1000, 'value': 0.09776811206387356}
l_cls: {'step': 1000, 'value': 0.09776811206387356}
step: {'step': 1000, 'value': 1000}
epoch: {'step': 1000, 'value': 7.620367163145134}
step_time: {'step': 1000, 'value': 0.03112736940383911}
env0_in_acc: {'step': 1000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1000, 'value': 0.0}
env0_in_demographic_parity: {'step': 1000, 'value': 0}
env0_in_equalized_odds: {'step': 1000, 'value': 0}
env0_in_auc_score: {'step': 1000, 'value': 0.5}
env1_in_acc: {'step': 1000, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 1000, 'value': 0.0}
env1_in_demographic_parity: {'step': 1000, 'value': 0}
env1_in_equalized_odds: {'step': 1000, 'value': 0}
env1_in_auc_score: {'step': 1000, 'value': 0.5}
env0_out_acc: {'step': 1000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1000, 'value': 0.0}
env0_out_demographic_parity: {'step': 1000, 'value': 0}
env0_out_equalized_odds: {'step': 1000, 'value': 0}
env0_out_auc_score: {'step': 1000, 'value': 0.5}
env1_out_acc: {'step': 1000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1000, 'value': 0.0}
env1_out_demographic_parity: {'step': 1000, 'value': 0}
env1_out_equalized_odds: {'step': 1000, 'value': 0}
env1_out_auc_score: {'step': 1000, 'value': 0.5}
------------------------------
[2025-04-27 18:43:44] 
Step 1500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0098
l_cls               : 0.0098
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:43:55] 
Evaluation at step 1501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0852 (mean)
l_cls               : 0.0852 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9840
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.90 MB
Final allocation   : 381.47 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1500.0000
epoch               : 11.4306
step_time           : 0.0311
loss                : 0.0852
l_cls               : 0.0852
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9840
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.031079779624938964, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.031079779624938964, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1500, 'value': 0.08522867177985609}
l_cls: {'step': 1500, 'value': 0.08522867177985609}
step: {'step': 1500, 'value': 1500}
epoch: {'step': 1500, 'value': 11.430550744717701}
step_time: {'step': 1500, 'value': 0.031079779624938964}
env0_in_acc: {'step': 1500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1500, 'value': 0.0}
env0_in_demographic_parity: {'step': 1500, 'value': 0}
env0_in_equalized_odds: {'step': 1500, 'value': 0}
env0_in_auc_score: {'step': 1500, 'value': 0.5}
env1_in_acc: {'step': 1500, 'value': 0.983982683982684}
env1_in_max_difference: {'step': 1500, 'value': 0.0}
env1_in_demographic_parity: {'step': 1500, 'value': 0}
env1_in_equalized_odds: {'step': 1500, 'value': 0}
env1_in_auc_score: {'step': 1500, 'value': 0.5}
env0_out_acc: {'step': 1500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1500, 'value': 0.0}
env0_out_demographic_parity: {'step': 1500, 'value': 0}
env0_out_equalized_odds: {'step': 1500, 'value': 0}
env0_out_auc_score: {'step': 1500, 'value': 0.5}
env1_out_acc: {'step': 1500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1500, 'value': 0.0}
env1_out_demographic_parity: {'step': 1500, 'value': 0}
env1_out_equalized_odds: {'step': 1500, 'value': 0}
env1_out_auc_score: {'step': 1500, 'value': 0.5}
------------------------------
[2025-04-27 18:44:11] 
Step 2000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1705
l_cls               : 0.1705
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:44:22] 
Evaluation at step 2001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0310 (mean)
loss                : 0.0753 (mean)
l_cls               : 0.0753 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9801
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2000.0000
epoch               : 15.2407
step_time           : 0.0310
loss                : 0.0753
l_cls               : 0.0753
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9801
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.031045020580291748, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.031045020580291748, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 2000, 'value': 0.07532603965706584}
l_cls: {'step': 2000, 'value': 0.07532603965706584}
step: {'step': 2000, 'value': 2000}
epoch: {'step': 2000, 'value': 15.240734326290267}
step_time: {'step': 2000, 'value': 0.031045020580291748}
env0_in_acc: {'step': 2000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 2000, 'value': 0.0}
env0_in_demographic_parity: {'step': 2000, 'value': 0}
env0_in_equalized_odds: {'step': 2000, 'value': 0}
env0_in_auc_score: {'step': 2000, 'value': 0.5}
env1_in_acc: {'step': 2000, 'value': 0.9800865800865801}
env1_in_max_difference: {'step': 2000, 'value': 0.0}
env1_in_demographic_parity: {'step': 2000, 'value': 0}
env1_in_equalized_odds: {'step': 2000, 'value': 0}
env1_in_auc_score: {'step': 2000, 'value': 0.5}
env0_out_acc: {'step': 2000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2000, 'value': 0.0}
env0_out_demographic_parity: {'step': 2000, 'value': 0}
env0_out_equalized_odds: {'step': 2000, 'value': 0}
env0_out_auc_score: {'step': 2000, 'value': 0.5}
env1_out_acc: {'step': 2000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 2000, 'value': 0.0}
env1_out_demographic_parity: {'step': 2000, 'value': 0}
env1_out_equalized_odds: {'step': 2000, 'value': 0}
env1_out_auc_score: {'step': 2000, 'value': 0.5}
------------------------------
[2025-04-27 18:44:38] 
Step 2500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0002
l_cls               : 0.0002
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:44:49] 
Evaluation at step 2501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0169 (mean)
l_cls               : 0.0169 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9858
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9991
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9809
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2500.0000
epoch               : 19.0509
step_time           : 0.0311
loss                : 0.0169
l_cls               : 0.0169
env0_in_acc         : 0.9858
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9991
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9809
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.031092084884643555, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.031092084884643555, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 2500, 'value': 0.016926033473597585}
l_cls: {'step': 2500, 'value': 0.016926033473597585}
step: {'step': 2500, 'value': 2500}
epoch: {'step': 2500, 'value': 19.050917907862836}
step_time: {'step': 2500, 'value': 0.031092084884643555}
env0_in_acc: {'step': 2500, 'value': 0.9858490566037735}
env0_in_max_difference: {'step': 2500, 'value': 0.0}
env0_in_demographic_parity: {'step': 2500, 'value': 0}
env0_in_equalized_odds: {'step': 2500, 'value': 0}
env0_in_auc_score: {'step': 2500, 'value': 0.5}
env1_in_acc: {'step': 2500, 'value': 0.9991341991341991}
env1_in_max_difference: {'step': 2500, 'value': 0.0}
env1_in_demographic_parity: {'step': 2500, 'value': 0}
env1_in_equalized_odds: {'step': 2500, 'value': 0}
env1_in_auc_score: {'step': 2500, 'value': 0.5}
env0_out_acc: {'step': 2500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2500, 'value': 0.0}
env0_out_demographic_parity: {'step': 2500, 'value': 0}
env0_out_equalized_odds: {'step': 2500, 'value': 0}
env0_out_auc_score: {'step': 2500, 'value': 0.5}
env1_out_acc: {'step': 2500, 'value': 0.9809358752166378}
env1_out_max_difference: {'step': 2500, 'value': 0.0}
env1_out_demographic_parity: {'step': 2500, 'value': 0}
env1_out_equalized_odds: {'step': 2500, 'value': 0}
env1_out_auc_score: {'step': 2500, 'value': 0.5}
------------------------------
[2025-04-27 18:45:05] 
Step 3000:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:45:17] 
Evaluation at step 3001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0310 (mean)
loss                : 0.0041 (mean)
l_cls               : 0.0041 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 3000.0000
epoch               : 22.8611
step_time           : 0.0310
loss                : 0.0041
l_cls               : 0.0041
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 3000: {'step': 3000, 'epoch': 22.861101489435402, 'step_time': 0.0310206937789917, 'loss': 0.004140488821261357, 'l_cls': 0.004140488821261357, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 3000: {'step': 3000, 'epoch': 22.861101489435402, 'step_time': 0.0310206937789917, 'loss': 0.004140488821261357, 'l_cls': 0.004140488821261357, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 3000, 'value': 0.004140488821261357}
l_cls: {'step': 3000, 'value': 0.004140488821261357}
step: {'step': 3000, 'value': 3000}
epoch: {'step': 3000, 'value': 22.861101489435402}
step_time: {'step': 3000, 'value': 0.0310206937789917}
env0_in_acc: {'step': 3000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 3000, 'value': 0.0}
env0_in_demographic_parity: {'step': 3000, 'value': 0}
env0_in_equalized_odds: {'step': 3000, 'value': 0}
env0_in_auc_score: {'step': 3000, 'value': 0.5}
env1_in_acc: {'step': 3000, 'value': 1.0}
env1_in_max_difference: {'step': 3000, 'value': 0.0}
env1_in_demographic_parity: {'step': 3000, 'value': 0}
env1_in_equalized_odds: {'step': 3000, 'value': 0}
env1_in_auc_score: {'step': 3000, 'value': 0.5}
env0_out_acc: {'step': 3000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 3000, 'value': 0.0}
env0_out_demographic_parity: {'step': 3000, 'value': 0}
env0_out_equalized_odds: {'step': 3000, 'value': 0}
env0_out_auc_score: {'step': 3000, 'value': 0.5}
env1_out_acc: {'step': 3000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 3000, 'value': 0.0}
env1_out_demographic_parity: {'step': 3000, 'value': 0}
env1_out_equalized_odds: {'step': 3000, 'value': 0}
env1_out_auc_score: {'step': 3000, 'value': 0.5}
------------------------------
[2025-04-27 18:45:32] 
Step 3500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:45:44] 
Evaluation at step 3501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 3500.0000
epoch               : 26.6713
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 3500: {'step': 3500, 'epoch': 26.67128507100797, 'step_time': 0.031051297187805176, 'loss': 1.592333407312907e-05, 'l_cls': 1.592333407312907e-05, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 3500: {'step': 3500, 'epoch': 26.67128507100797, 'step_time': 0.031051297187805176, 'loss': 1.592333407312907e-05, 'l_cls': 1.592333407312907e-05, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 3500, 'value': 1.592333407312907e-05}
l_cls: {'step': 3500, 'value': 1.592333407312907e-05}
step: {'step': 3500, 'value': 3500}
epoch: {'step': 3500, 'value': 26.67128507100797}
step_time: {'step': 3500, 'value': 0.031051297187805176}
env0_in_acc: {'step': 3500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 3500, 'value': 0.0}
env0_in_demographic_parity: {'step': 3500, 'value': 0}
env0_in_equalized_odds: {'step': 3500, 'value': 0}
env0_in_auc_score: {'step': 3500, 'value': 0.5}
env1_in_acc: {'step': 3500, 'value': 1.0}
env1_in_max_difference: {'step': 3500, 'value': 0.0}
env1_in_demographic_parity: {'step': 3500, 'value': 0}
env1_in_equalized_odds: {'step': 3500, 'value': 0}
env1_in_auc_score: {'step': 3500, 'value': 0.5}
env0_out_acc: {'step': 3500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 3500, 'value': 0.0}
env0_out_demographic_parity: {'step': 3500, 'value': 0}
env0_out_equalized_odds: {'step': 3500, 'value': 0}
env0_out_auc_score: {'step': 3500, 'value': 0.5}
env1_out_acc: {'step': 3500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 3500, 'value': 0.0}
env1_out_demographic_parity: {'step': 3500, 'value': 0}
env1_out_equalized_odds: {'step': 3500, 'value': 0}
env1_out_auc_score: {'step': 3500, 'value': 0.5}
------------------------------
[2025-04-27 18:45:59] 
Step 4000:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:46:11] 
Evaluation at step 4001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0310 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 4000.0000
epoch               : 30.4815
step_time           : 0.0310
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 4000: {'step': 4000, 'epoch': 30.481468652580535, 'step_time': 0.031037460327148436, 'loss': 4.853858316134385e-06, 'l_cls': 4.853858316134385e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 4000: {'step': 4000, 'epoch': 30.481468652580535, 'step_time': 0.031037460327148436, 'loss': 4.853858316134385e-06, 'l_cls': 4.853858316134385e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 4000, 'value': 4.853858316134385e-06}
l_cls: {'step': 4000, 'value': 4.853858316134385e-06}
step: {'step': 4000, 'value': 4000}
epoch: {'step': 4000, 'value': 30.481468652580535}
step_time: {'step': 4000, 'value': 0.031037460327148436}
env0_in_acc: {'step': 4000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 4000, 'value': 0.0}
env0_in_demographic_parity: {'step': 4000, 'value': 0}
env0_in_equalized_odds: {'step': 4000, 'value': 0}
env0_in_auc_score: {'step': 4000, 'value': 0.5}
env1_in_acc: {'step': 4000, 'value': 1.0}
env1_in_max_difference: {'step': 4000, 'value': 0.0}
env1_in_demographic_parity: {'step': 4000, 'value': 0}
env1_in_equalized_odds: {'step': 4000, 'value': 0}
env1_in_auc_score: {'step': 4000, 'value': 0.5}
env0_out_acc: {'step': 4000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 4000, 'value': 0.0}
env0_out_demographic_parity: {'step': 4000, 'value': 0}
env0_out_equalized_odds: {'step': 4000, 'value': 0}
env0_out_auc_score: {'step': 4000, 'value': 0.5}
env1_out_acc: {'step': 4000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 4000, 'value': 0.0}
env1_out_demographic_parity: {'step': 4000, 'value': 0}
env1_out_equalized_odds: {'step': 4000, 'value': 0}
env1_out_auc_score: {'step': 4000, 'value': 0.5}
------------------------------
[2025-04-27 18:46:26] 
Step 4500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:46:38] 
Evaluation at step 4501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 4500.0000
epoch               : 34.2917
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 4500: {'step': 4500, 'epoch': 34.291652234153105, 'step_time': 0.031113522052764894, 'loss': 2.705674614656317e-06, 'l_cls': 2.705674614656317e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 4500: {'step': 4500, 'epoch': 34.291652234153105, 'step_time': 0.031113522052764894, 'loss': 2.705674614656317e-06, 'l_cls': 2.705674614656317e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 4500, 'value': 2.705674614656317e-06}
l_cls: {'step': 4500, 'value': 2.705674614656317e-06}
step: {'step': 4500, 'value': 4500}
epoch: {'step': 4500, 'value': 34.291652234153105}
step_time: {'step': 4500, 'value': 0.031113522052764894}
env0_in_acc: {'step': 4500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 4500, 'value': 0.0}
env0_in_demographic_parity: {'step': 4500, 'value': 0}
env0_in_equalized_odds: {'step': 4500, 'value': 0}
env0_in_auc_score: {'step': 4500, 'value': 0.5}
env1_in_acc: {'step': 4500, 'value': 1.0}
env1_in_max_difference: {'step': 4500, 'value': 0.0}
env1_in_demographic_parity: {'step': 4500, 'value': 0}
env1_in_equalized_odds: {'step': 4500, 'value': 0}
env1_in_auc_score: {'step': 4500, 'value': 0.5}
env0_out_acc: {'step': 4500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 4500, 'value': 0.0}
env0_out_demographic_parity: {'step': 4500, 'value': 0}
env0_out_equalized_odds: {'step': 4500, 'value': 0}
env0_out_auc_score: {'step': 4500, 'value': 0.5}
env1_out_acc: {'step': 4500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 4500, 'value': 0.0}
env1_out_demographic_parity: {'step': 4500, 'value': 0}
env1_out_equalized_odds: {'step': 4500, 'value': 0}
env1_out_auc_score: {'step': 4500, 'value': 0.5}
------------------------------
[2025-04-27 18:46:54] 
Step 5000:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:47:05] 
Evaluation at step 5001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 5000.0000
epoch               : 38.1018
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 5000: {'step': 5000, 'epoch': 38.10183581572567, 'step_time': 0.031140785694122316, 'loss': 1.7259902275537087e-06, 'l_cls': 1.7259902275537087e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 5000: {'step': 5000, 'epoch': 38.10183581572567, 'step_time': 0.031140785694122316, 'loss': 1.7259902275537087e-06, 'l_cls': 1.7259902275537087e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 5000, 'value': 1.7259902275537087e-06}
l_cls: {'step': 5000, 'value': 1.7259902275537087e-06}
step: {'step': 5000, 'value': 5000}
epoch: {'step': 5000, 'value': 38.10183581572567}
step_time: {'step': 5000, 'value': 0.031140785694122316}
env0_in_acc: {'step': 5000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 5000, 'value': 0.0}
env0_in_demographic_parity: {'step': 5000, 'value': 0}
env0_in_equalized_odds: {'step': 5000, 'value': 0}
env0_in_auc_score: {'step': 5000, 'value': 0.5}
env1_in_acc: {'step': 5000, 'value': 1.0}
env1_in_max_difference: {'step': 5000, 'value': 0.0}
env1_in_demographic_parity: {'step': 5000, 'value': 0}
env1_in_equalized_odds: {'step': 5000, 'value': 0}
env1_in_auc_score: {'step': 5000, 'value': 0.5}
env0_out_acc: {'step': 5000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 5000, 'value': 0.0}
env0_out_demographic_parity: {'step': 5000, 'value': 0}
env0_out_equalized_odds: {'step': 5000, 'value': 0}
env0_out_auc_score: {'step': 5000, 'value': 0.5}
env1_out_acc: {'step': 5000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 5000, 'value': 0.0}
env1_out_demographic_parity: {'step': 5000, 'value': 0}
env1_out_equalized_odds: {'step': 5000, 'value': 0}
env1_out_auc_score: {'step': 5000, 'value': 0.5}
------------------------------
[2025-04-27 18:47:21] 
Step 5500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:47:32] 
Evaluation at step 5501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 5500.0000
epoch               : 41.9120
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 5500: {'step': 5500, 'epoch': 41.91201939729824, 'step_time': 0.031122027397155763, 'loss': 1.105970932392175e-06, 'l_cls': 1.105970932392175e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 5500: {'step': 5500, 'epoch': 41.91201939729824, 'step_time': 0.031122027397155763, 'loss': 1.105970932392175e-06, 'l_cls': 1.105970932392175e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 5500, 'value': 1.105970932392175e-06}
l_cls: {'step': 5500, 'value': 1.105970932392175e-06}
step: {'step': 5500, 'value': 5500}
epoch: {'step': 5500, 'value': 41.91201939729824}
step_time: {'step': 5500, 'value': 0.031122027397155763}
env0_in_acc: {'step': 5500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 5500, 'value': 0.0}
env0_in_demographic_parity: {'step': 5500, 'value': 0}
env0_in_equalized_odds: {'step': 5500, 'value': 0}
env0_in_auc_score: {'step': 5500, 'value': 0.5}
env1_in_acc: {'step': 5500, 'value': 1.0}
env1_in_max_difference: {'step': 5500, 'value': 0.0}
env1_in_demographic_parity: {'step': 5500, 'value': 0}
env1_in_equalized_odds: {'step': 5500, 'value': 0}
env1_in_auc_score: {'step': 5500, 'value': 0.5}
env0_out_acc: {'step': 5500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 5500, 'value': 0.0}
env0_out_demographic_parity: {'step': 5500, 'value': 0}
env0_out_equalized_odds: {'step': 5500, 'value': 0}
env0_out_auc_score: {'step': 5500, 'value': 0.5}
env1_out_acc: {'step': 5500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 5500, 'value': 0.0}
env1_out_demographic_parity: {'step': 5500, 'value': 0}
env1_out_equalized_odds: {'step': 5500, 'value': 0}
env1_out_auc_score: {'step': 5500, 'value': 0.5}
------------------------------
[2025-04-27 18:47:48] 
Step 6000:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:47:59] 
Evaluation at step 6001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 6000.0000
epoch               : 45.7222
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 6000: {'step': 6000, 'epoch': 45.722202978870804, 'step_time': 0.03110555124282837, 'loss': 6.85471769122259e-07, 'l_cls': 6.85471769122259e-07, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 6000: {'step': 6000, 'epoch': 45.722202978870804, 'step_time': 0.03110555124282837, 'loss': 6.85471769122259e-07, 'l_cls': 6.85471769122259e-07, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 6000, 'value': 6.85471769122259e-07}
l_cls: {'step': 6000, 'value': 6.85471769122259e-07}
step: {'step': 6000, 'value': 6000}
epoch: {'step': 6000, 'value': 45.722202978870804}
step_time: {'step': 6000, 'value': 0.03110555124282837}
env0_in_acc: {'step': 6000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 6000, 'value': 0.0}
env0_in_demographic_parity: {'step': 6000, 'value': 0}
env0_in_equalized_odds: {'step': 6000, 'value': 0}
env0_in_auc_score: {'step': 6000, 'value': 0.5}
env1_in_acc: {'step': 6000, 'value': 1.0}
env1_in_max_difference: {'step': 6000, 'value': 0.0}
env1_in_demographic_parity: {'step': 6000, 'value': 0}
env1_in_equalized_odds: {'step': 6000, 'value': 0}
env1_in_auc_score: {'step': 6000, 'value': 0.5}
env0_out_acc: {'step': 6000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 6000, 'value': 0.0}
env0_out_demographic_parity: {'step': 6000, 'value': 0}
env0_out_equalized_odds: {'step': 6000, 'value': 0}
env0_out_auc_score: {'step': 6000, 'value': 0.5}
env1_out_acc: {'step': 6000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 6000, 'value': 0.0}
env1_out_demographic_parity: {'step': 6000, 'value': 0}
env1_out_equalized_odds: {'step': 6000, 'value': 0}
env1_out_auc_score: {'step': 6000, 'value': 0.5}
------------------------------
[2025-04-27 18:48:15] 
Step 6500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 18:48:26] 
Evaluation at step 6501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
WARNING: Invalid max_difference value: inf
max_difference      : 0.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 6500.0000
epoch               : 49.5324
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 0.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 0.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 0.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 0.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 6500: {'step': 6500, 'epoch': 49.53238656044337, 'step_time': 0.03113735294342041, 'loss': 5.271469792971217e-07, 'l_cls': 5.271469792971217e-07, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 6500: {'step': 6500, 'epoch': 49.53238656044337, 'step_time': 0.03113735294342041, 'loss': 5.271469792971217e-07, 'l_cls': 5.271469792971217e-07, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 0.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 0.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 0.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 0.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 6500, 'value': 5.271469792971217e-07}
l_cls: {'step': 6500, 'value': 5.271469792971217e-07}
step: {'step': 6500, 'value': 6500}
epoch: {'step': 6500, 'value': 49.53238656044337}
step_time: {'step': 6500, 'value': 0.03113735294342041}
env0_in_acc: {'step': 6500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 6500, 'value': 0.0}
env0_in_demographic_parity: {'step': 6500, 'value': 0}
env0_in_equalized_odds: {'step': 6500, 'value': 0}
env0_in_auc_score: {'step': 6500, 'value': 0.5}
env1_in_acc: {'step': 6500, 'value': 1.0}
env1_in_max_difference: {'step': 6500, 'value': 0.0}
env1_in_demographic_parity: {'step': 6500, 'value': 0}
env1_in_equalized_odds: {'step': 6500, 'value': 0}
env1_in_auc_score: {'step': 6500, 'value': 0.5}
env0_out_acc: {'step': 6500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 6500, 'value': 0.0}
env0_out_demographic_parity: {'step': 6500, 'value': 0}
env0_out_equalized_odds: {'step': 6500, 'value': 0}
env0_out_auc_score: {'step': 6500, 'value': 0.5}
env1_out_acc: {'step': 6500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 6500, 'value': 0.0}
env1_out_demographic_parity: {'step': 6500, 'value': 0}
env1_out_equalized_odds: {'step': 6500, 'value': 0}
env1_out_auc_score: {'step': 6500, 'value': 0.5}
------------------------------
[2025-04-27 18:48:42] 
Step 7000:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Keyboard interrupt received. Stopping training...

Shutting down training manager...
Shutting down training manager...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...
Exception in thread Thread-5:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 379, in webapp_training_loop
    results = self.evaluate()
  File "debug_webapp_training.py", line 98, in evaluate
    for batch_idx, (x, y, z) in enumerate(loader):
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/lib/fast_data_loader.py", line 69, in __iter__
    yield next(self._infinite_iterator)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1293, in _get_data
    success, data = self._try_get_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 496, in rebuild_storage_fd
    fd = df.detach()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory

Training simulation completed!
==================================================
Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders

Evaluation loader names: ['env0_in', 'env1_in', 'env0_out', 'env1_out']
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard

Starting webapp training loop simulation...
Will evaluate every None steps
==================================================
Starting training thread...
[2025-04-27 18:49:04] 
Starting training loop...
[2025-04-27 18:49:04] ==================================================
[2025-04-27 18:49:04] Total steps per epoch: 131.22727272727272
[2025-04-27 18:49:04] Target epochs: Not specified
[2025-04-27 18:49:04] ==================================================

Metrics Update:
------------------------------
------------------------------
[2025-04-27 18:49:20] 
Step 500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0101
l_cls               : 0.0101
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...

Keyboard interrupt received. Stopping training...

Shutting down training manager...
Shutting down training manager...
[2025-04-27 18:49:32] 
Evaluation at step 501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0330 (mean)
loss                : 0.1103 (mean)
l_cls               : 0.1103 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 382.66 MB
Final allocation   : 383.24 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 500.0000
epoch               : 3.8102
step_time           : 0.0330
loss                : 0.1103
l_cls               : 0.1103
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03303476476669311, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03303476476669311, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 500, 'value': 0.11032169118573074}
l_cls: {'step': 500, 'value': 0.11032169118573074}
step: {'step': 500, 'value': 500}
epoch: {'step': 500, 'value': 3.810183581572567}
step_time: {'step': 500, 'value': 0.03303476476669311}
env0_in_acc: {'step': 500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 500, 'value': 1.0}
env0_in_demographic_parity: {'step': 500, 'value': 0}
env0_in_equalized_odds: {'step': 500, 'value': 0}
env0_in_auc_score: {'step': 500, 'value': 0.5}
env1_in_acc: {'step': 500, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 500, 'value': 1.0}
env1_in_demographic_parity: {'step': 500, 'value': 0}
env1_in_equalized_odds: {'step': 500, 'value': 0}
env1_in_auc_score: {'step': 500, 'value': 0.5}
env0_out_acc: {'step': 500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 500, 'value': 1.0}
env0_out_demographic_parity: {'step': 500, 'value': 0}
env0_out_equalized_odds: {'step': 500, 'value': 0}
env0_out_auc_score: {'step': 500, 'value': 0.5}
env1_out_acc: {'step': 500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 500, 'value': 1.0}
env1_out_demographic_parity: {'step': 500, 'value': 0}
env1_out_equalized_odds: {'step': 500, 'value': 0}
env1_out_auc_score: {'step': 500, 'value': 0.5}
------------------------------

Training simulation completed!
==================================================
Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders

Evaluation loader names: ['env0_in', 'env1_in', 'env0_out', 'env1_out']
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard

Starting webapp training loop simulation...
Will evaluate every None steps
==================================================
Starting training thread...
[2025-04-27 19:06:38] 
Starting training loop...
[2025-04-27 19:06:38] ==================================================
[2025-04-27 19:06:38] Total steps per epoch: 131.22727272727272
[2025-04-27 19:06:38] Target epochs: Not specified
[2025-04-27 19:06:38] ==================================================

Metrics Update:
------------------------------
------------------------------
[2025-04-27 19:06:55] 
Step 500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0101
l_cls               : 0.0101
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:07:06] 
Evaluation at step 501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0321 (mean)
loss                : 0.1103 (mean)
l_cls               : 0.1103 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 382.66 MB
Final allocation   : 383.24 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 500.0000
epoch               : 3.8102
step_time           : 0.0321
loss                : 0.1103
l_cls               : 0.1103
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03207347631454468, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03207347631454468, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 500, 'value': 0.11032169118573074}
l_cls: {'step': 500, 'value': 0.11032169118573074}
step: {'step': 500, 'value': 500}
epoch: {'step': 500, 'value': 3.810183581572567}
step_time: {'step': 500, 'value': 0.03207347631454468}
env0_in_acc: {'step': 500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 500, 'value': 1.0}
env0_in_demographic_parity: {'step': 500, 'value': 0}
env0_in_equalized_odds: {'step': 500, 'value': 0}
env0_in_auc_score: {'step': 500, 'value': 0.5}
env1_in_acc: {'step': 500, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 500, 'value': 1.0}
env1_in_demographic_parity: {'step': 500, 'value': 0}
env1_in_equalized_odds: {'step': 500, 'value': 0}
env1_in_auc_score: {'step': 500, 'value': 0.5}
env0_out_acc: {'step': 500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 500, 'value': 1.0}
env0_out_demographic_parity: {'step': 500, 'value': 0}
env0_out_equalized_odds: {'step': 500, 'value': 0}
env0_out_auc_score: {'step': 500, 'value': 0.5}
env1_out_acc: {'step': 500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 500, 'value': 1.0}
env1_out_demographic_parity: {'step': 500, 'value': 0}
env1_out_equalized_odds: {'step': 500, 'value': 0}
env1_out_auc_score: {'step': 500, 'value': 0.5}
------------------------------
[2025-04-27 19:07:22] 
Step 1000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1904
l_cls               : 0.1904
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:07:34] 
Evaluation at step 1001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0978 (mean)
l_cls               : 0.0978 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.20 MB
Final allocation   : 380.78 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1000.0000
epoch               : 7.6204
step_time           : 0.0311
loss                : 0.0978
l_cls               : 0.0978
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.031061827659606935, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.031061827659606935, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1000, 'value': 0.09776811206387356}
l_cls: {'step': 1000, 'value': 0.09776811206387356}
step: {'step': 1000, 'value': 1000}
epoch: {'step': 1000, 'value': 7.620367163145134}
step_time: {'step': 1000, 'value': 0.031061827659606935}
env0_in_acc: {'step': 1000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1000, 'value': 1.0}
env0_in_demographic_parity: {'step': 1000, 'value': 0}
env0_in_equalized_odds: {'step': 1000, 'value': 0}
env0_in_auc_score: {'step': 1000, 'value': 0.5}
env1_in_acc: {'step': 1000, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 1000, 'value': 1.0}
env1_in_demographic_parity: {'step': 1000, 'value': 0}
env1_in_equalized_odds: {'step': 1000, 'value': 0}
env1_in_auc_score: {'step': 1000, 'value': 0.5}
env0_out_acc: {'step': 1000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1000, 'value': 1.0}
env0_out_demographic_parity: {'step': 1000, 'value': 0}
env0_out_equalized_odds: {'step': 1000, 'value': 0}
env0_out_auc_score: {'step': 1000, 'value': 0.5}
env1_out_acc: {'step': 1000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1000, 'value': 1.0}
env1_out_demographic_parity: {'step': 1000, 'value': 0}
env1_out_equalized_odds: {'step': 1000, 'value': 0}
env1_out_auc_score: {'step': 1000, 'value': 0.5}
------------------------------
[2025-04-27 19:07:49] 
Step 1500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0098
l_cls               : 0.0098
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:08:01] 
Evaluation at step 1501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0852 (mean)
l_cls               : 0.0852 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9840
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.63 MB
Final allocation   : 381.21 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1500.0000
epoch               : 11.4306
step_time           : 0.0311
loss                : 0.0852
l_cls               : 0.0852
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9840
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.031114341259002684, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.031114341259002684, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1500, 'value': 0.08522867177985609}
l_cls: {'step': 1500, 'value': 0.08522867177985609}
step: {'step': 1500, 'value': 1500}
epoch: {'step': 1500, 'value': 11.430550744717701}
step_time: {'step': 1500, 'value': 0.031114341259002684}
env0_in_acc: {'step': 1500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1500, 'value': 1.0}
env0_in_demographic_parity: {'step': 1500, 'value': 0}
env0_in_equalized_odds: {'step': 1500, 'value': 0}
env0_in_auc_score: {'step': 1500, 'value': 0.5}
env1_in_acc: {'step': 1500, 'value': 0.983982683982684}
env1_in_max_difference: {'step': 1500, 'value': 1.0}
env1_in_demographic_parity: {'step': 1500, 'value': 0}
env1_in_equalized_odds: {'step': 1500, 'value': 0}
env1_in_auc_score: {'step': 1500, 'value': 0.5}
env0_out_acc: {'step': 1500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1500, 'value': 1.0}
env0_out_demographic_parity: {'step': 1500, 'value': 0}
env0_out_equalized_odds: {'step': 1500, 'value': 0}
env0_out_auc_score: {'step': 1500, 'value': 0.5}
env1_out_acc: {'step': 1500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1500, 'value': 1.0}
env1_out_demographic_parity: {'step': 1500, 'value': 0}
env1_out_equalized_odds: {'step': 1500, 'value': 0}
env1_out_auc_score: {'step': 1500, 'value': 0.5}
------------------------------
[2025-04-27 19:08:17] 
Step 2000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1705
l_cls               : 0.1705
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:08:28] 
Evaluation at step 2001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0753 (mean)
l_cls               : 0.0753 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9801
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.63 MB
Final allocation   : 381.21 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2000.0000
epoch               : 15.2407
step_time           : 0.0311
loss                : 0.0753
l_cls               : 0.0753
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9801
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.03110825061798096, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.03110825061798096, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 2000, 'value': 0.07532603965706584}
l_cls: {'step': 2000, 'value': 0.07532603965706584}
step: {'step': 2000, 'value': 2000}
epoch: {'step': 2000, 'value': 15.240734326290267}
step_time: {'step': 2000, 'value': 0.03110825061798096}
env0_in_acc: {'step': 2000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 2000, 'value': 1.0}
env0_in_demographic_parity: {'step': 2000, 'value': 0}
env0_in_equalized_odds: {'step': 2000, 'value': 0}
env0_in_auc_score: {'step': 2000, 'value': 0.5}
env1_in_acc: {'step': 2000, 'value': 0.9800865800865801}
env1_in_max_difference: {'step': 2000, 'value': 1.0}
env1_in_demographic_parity: {'step': 2000, 'value': 0}
env1_in_equalized_odds: {'step': 2000, 'value': 0}
env1_in_auc_score: {'step': 2000, 'value': 0.5}
env0_out_acc: {'step': 2000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2000, 'value': 1.0}
env0_out_demographic_parity: {'step': 2000, 'value': 0}
env0_out_equalized_odds: {'step': 2000, 'value': 0}
env0_out_auc_score: {'step': 2000, 'value': 0.5}
env1_out_acc: {'step': 2000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 2000, 'value': 1.0}
env1_out_demographic_parity: {'step': 2000, 'value': 0}
env1_out_equalized_odds: {'step': 2000, 'value': 0}
env1_out_auc_score: {'step': 2000, 'value': 0.5}
------------------------------
[2025-04-27 19:08:44] 
Step 2500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0002
l_cls               : 0.0002
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:08:55] 
Evaluation at step 2501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0312 (mean)
loss                : 0.0169 (mean)
l_cls               : 0.0169 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9858
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9991
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9809
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.63 MB
Final allocation   : 381.21 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2500.0000
epoch               : 19.0509
step_time           : 0.0312
loss                : 0.0169
l_cls               : 0.0169
env0_in_acc         : 0.9858
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9991
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9809
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.03119017267227173, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.03119017267227173, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 2500, 'value': 0.016926033473597585}
l_cls: {'step': 2500, 'value': 0.016926033473597585}
step: {'step': 2500, 'value': 2500}
epoch: {'step': 2500, 'value': 19.050917907862836}
step_time: {'step': 2500, 'value': 0.03119017267227173}
env0_in_acc: {'step': 2500, 'value': 0.9858490566037735}
env0_in_max_difference: {'step': 2500, 'value': 1.0}
env0_in_demographic_parity: {'step': 2500, 'value': 0}
env0_in_equalized_odds: {'step': 2500, 'value': 0}
env0_in_auc_score: {'step': 2500, 'value': 0.5}
env1_in_acc: {'step': 2500, 'value': 0.9991341991341991}
env1_in_max_difference: {'step': 2500, 'value': 1.0}
env1_in_demographic_parity: {'step': 2500, 'value': 0}
env1_in_equalized_odds: {'step': 2500, 'value': 0}
env1_in_auc_score: {'step': 2500, 'value': 0.5}
env0_out_acc: {'step': 2500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2500, 'value': 1.0}
env0_out_demographic_parity: {'step': 2500, 'value': 0}
env0_out_equalized_odds: {'step': 2500, 'value': 0}
env0_out_auc_score: {'step': 2500, 'value': 0.5}
env1_out_acc: {'step': 2500, 'value': 0.9809358752166378}
env1_out_max_difference: {'step': 2500, 'value': 1.0}
env1_out_demographic_parity: {'step': 2500, 'value': 0}
env1_out_equalized_odds: {'step': 2500, 'value': 0}
env1_out_auc_score: {'step': 2500, 'value': 0.5}
------------------------------
[2025-04-27 19:09:11] 
Step 3000:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Keyboard interrupt received. Stopping training...

Shutting down training manager...
Shutting down training manager...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...
Exception in thread Thread-5:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 379, in webapp_training_loop
    results = self.evaluate()
  File "debug_webapp_training.py", line 98, in evaluate
    for batch_idx, (x, y, z) in enumerate(loader):
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/lib/fast_data_loader.py", line 69, in __iter__
    yield next(self._infinite_iterator)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1293, in _get_data
    success, data = self._try_get_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 496, in rebuild_storage_fd
    fd = df.detach()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory

Training simulation completed!
==================================================
Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders

Checking class distribution in evaluation data:

Split 0 (in):
Total samples: 424
Class distribution:
  Class 0: 420 samples (99.1%)
  Class 1: 4 samples (0.9%)

Split 1 (in):
Total samples: 2310
Class distribution:
  Class 0: 2262 samples (97.9%)
  Class 1: 48 samples (2.1%)

Split 2 (out):
Total samples: 105
Class distribution:
  Class 0: 104 samples (99.0%)
  Class 1: 1 samples (1.0%)

Split 3 (out):
Total samples: 577
Class distribution:
  Class 0: 567 samples (98.3%)
  Class 1: 10 samples (1.7%)

Evaluation loader names: ['env0_in', 'env1_in', 'env0_out', 'env1_out']
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard

Starting webapp training loop simulation...
Will evaluate every None steps
==================================================
Starting training thread...
[2025-04-27 19:23:08] 
Starting training loop...
[2025-04-27 19:23:08] ==================================================
[2025-04-27 19:23:08] Total steps per epoch: 131.22727272727272
[2025-04-27 19:23:08] Target epochs: Not specified
[2025-04-27 19:23:08] ==================================================

Metrics Update:
------------------------------
------------------------------
[2025-04-27 19:23:25] 
Step 500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0101
l_cls               : 0.0101
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:23:36] 
Evaluation at step 501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0320 (mean)
loss                : 0.1103 (mean)
l_cls               : 0.1103 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 382.66 MB
Final allocation   : 383.24 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 500.0000
epoch               : 3.8102
step_time           : 0.0320
loss                : 0.1103
l_cls               : 0.1103
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03202456283569336, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03202456283569336, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 500, 'value': 0.11032169118573074}
l_cls: {'step': 500, 'value': 0.11032169118573074}
step: {'step': 500, 'value': 500}
epoch: {'step': 500, 'value': 3.810183581572567}
step_time: {'step': 500, 'value': 0.03202456283569336}
env0_in_acc: {'step': 500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 500, 'value': 1.0}
env0_in_demographic_parity: {'step': 500, 'value': 0}
env0_in_equalized_odds: {'step': 500, 'value': 0}
env0_in_auc_score: {'step': 500, 'value': 0.5}
env1_in_acc: {'step': 500, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 500, 'value': 1.0}
env1_in_demographic_parity: {'step': 500, 'value': 0}
env1_in_equalized_odds: {'step': 500, 'value': 0}
env1_in_auc_score: {'step': 500, 'value': 0.5}
env0_out_acc: {'step': 500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 500, 'value': 1.0}
env0_out_demographic_parity: {'step': 500, 'value': 0}
env0_out_equalized_odds: {'step': 500, 'value': 0}
env0_out_auc_score: {'step': 500, 'value': 0.5}
env1_out_acc: {'step': 500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 500, 'value': 1.0}
env1_out_demographic_parity: {'step': 500, 'value': 0}
env1_out_equalized_odds: {'step': 500, 'value': 0}
env1_out_auc_score: {'step': 500, 'value': 0.5}
------------------------------
[2025-04-27 19:23:52] 
Step 1000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1904
l_cls               : 0.1904
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:24:03] 
Evaluation at step 1001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0978 (mean)
l_cls               : 0.0978 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.20 MB
Final allocation   : 380.78 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1000.0000
epoch               : 7.6204
step_time           : 0.0311
loss                : 0.0978
l_cls               : 0.0978
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.031098005771636964, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.031098005771636964, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1000, 'value': 0.09776811206387356}
l_cls: {'step': 1000, 'value': 0.09776811206387356}
step: {'step': 1000, 'value': 1000}
epoch: {'step': 1000, 'value': 7.620367163145134}
step_time: {'step': 1000, 'value': 0.031098005771636964}
env0_in_acc: {'step': 1000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1000, 'value': 1.0}
env0_in_demographic_parity: {'step': 1000, 'value': 0}
env0_in_equalized_odds: {'step': 1000, 'value': 0}
env0_in_auc_score: {'step': 1000, 'value': 0.5}
env1_in_acc: {'step': 1000, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 1000, 'value': 1.0}
env1_in_demographic_parity: {'step': 1000, 'value': 0}
env1_in_equalized_odds: {'step': 1000, 'value': 0}
env1_in_auc_score: {'step': 1000, 'value': 0.5}
env0_out_acc: {'step': 1000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1000, 'value': 1.0}
env0_out_demographic_parity: {'step': 1000, 'value': 0}
env0_out_equalized_odds: {'step': 1000, 'value': 0}
env0_out_auc_score: {'step': 1000, 'value': 0.5}
env1_out_acc: {'step': 1000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1000, 'value': 1.0}
env1_out_demographic_parity: {'step': 1000, 'value': 0}
env1_out_equalized_odds: {'step': 1000, 'value': 0}
env1_out_auc_score: {'step': 1000, 'value': 0.5}
------------------------------
[2025-04-27 19:24:19] 
Step 1500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0098
l_cls               : 0.0098
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:24:30] 
Evaluation at step 1501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0852 (mean)
l_cls               : 0.0852 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9840
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.63 MB
Final allocation   : 381.21 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1500.0000
epoch               : 11.4306
step_time           : 0.0311
loss                : 0.0852
l_cls               : 0.0852
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9840
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.031070707798004152, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.031070707798004152, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1500, 'value': 0.08522867177985609}
l_cls: {'step': 1500, 'value': 0.08522867177985609}
step: {'step': 1500, 'value': 1500}
epoch: {'step': 1500, 'value': 11.430550744717701}
step_time: {'step': 1500, 'value': 0.031070707798004152}
env0_in_acc: {'step': 1500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1500, 'value': 1.0}
env0_in_demographic_parity: {'step': 1500, 'value': 0}
env0_in_equalized_odds: {'step': 1500, 'value': 0}
env0_in_auc_score: {'step': 1500, 'value': 0.5}
env1_in_acc: {'step': 1500, 'value': 0.983982683982684}
env1_in_max_difference: {'step': 1500, 'value': 1.0}
env1_in_demographic_parity: {'step': 1500, 'value': 0}
env1_in_equalized_odds: {'step': 1500, 'value': 0}
env1_in_auc_score: {'step': 1500, 'value': 0.5}
env0_out_acc: {'step': 1500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1500, 'value': 1.0}
env0_out_demographic_parity: {'step': 1500, 'value': 0}
env0_out_equalized_odds: {'step': 1500, 'value': 0}
env0_out_auc_score: {'step': 1500, 'value': 0.5}
env1_out_acc: {'step': 1500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1500, 'value': 1.0}
env1_out_demographic_parity: {'step': 1500, 'value': 0}
env1_out_equalized_odds: {'step': 1500, 'value': 0}
env1_out_auc_score: {'step': 1500, 'value': 0.5}
------------------------------
[2025-04-27 19:24:46] 
Step 2000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1705
l_cls               : 0.1705
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:24:57] 
Evaluation at step 2001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0753 (mean)
l_cls               : 0.0753 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9801
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.63 MB
Final allocation   : 381.21 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2000.0000
epoch               : 15.2407
step_time           : 0.0311
loss                : 0.0753
l_cls               : 0.0753
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9801
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.031108160495758055, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.031108160495758055, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 2000, 'value': 0.07532603965706584}
l_cls: {'step': 2000, 'value': 0.07532603965706584}
step: {'step': 2000, 'value': 2000}
epoch: {'step': 2000, 'value': 15.240734326290267}
step_time: {'step': 2000, 'value': 0.031108160495758055}
env0_in_acc: {'step': 2000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 2000, 'value': 1.0}
env0_in_demographic_parity: {'step': 2000, 'value': 0}
env0_in_equalized_odds: {'step': 2000, 'value': 0}
env0_in_auc_score: {'step': 2000, 'value': 0.5}
env1_in_acc: {'step': 2000, 'value': 0.9800865800865801}
env1_in_max_difference: {'step': 2000, 'value': 1.0}
env1_in_demographic_parity: {'step': 2000, 'value': 0}
env1_in_equalized_odds: {'step': 2000, 'value': 0}
env1_in_auc_score: {'step': 2000, 'value': 0.5}
env0_out_acc: {'step': 2000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2000, 'value': 1.0}
env0_out_demographic_parity: {'step': 2000, 'value': 0}
env0_out_equalized_odds: {'step': 2000, 'value': 0}
env0_out_auc_score: {'step': 2000, 'value': 0.5}
env1_out_acc: {'step': 2000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 2000, 'value': 1.0}
env1_out_demographic_parity: {'step': 2000, 'value': 0}
env1_out_equalized_odds: {'step': 2000, 'value': 0}
env1_out_auc_score: {'step': 2000, 'value': 0.5}
------------------------------
[2025-04-27 19:25:13] 
Step 2500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0002
l_cls               : 0.0002
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...

Keyboard interrupt received. Stopping training...

Shutting down training manager...
Shutting down training manager...
[2025-04-27 19:25:24] 
Evaluation at step 2501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0312 (mean)
loss                : 0.0169 (mean)
l_cls               : 0.0169 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9858
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9991
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9809
Error computing equalized_odds for env1_out: [Errno 2] No such file or directory
Error computing auc_score for env1_out: [Errno 2] No such file or directory
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.0000

GPU Memory Statistics:
Initial allocation : 380.63 MB
Final allocation   : 381.21 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2500.0000
epoch               : 19.0509
step_time           : 0.0312
loss                : 0.0169
l_cls               : 0.0169
env0_in_acc         : 0.9858
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9991
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9809
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.0000
==================================================
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.03115120220184326, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0.0, 'env1_out_auc_score': 0.0}
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.03115120220184326, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0.0, 'env1_out_auc_score': 0.0}

Metrics Update:
------------------------------
loss: {'step': 2500, 'value': 0.016926033473597585}
l_cls: {'step': 2500, 'value': 0.016926033473597585}
step: {'step': 2500, 'value': 2500}
epoch: {'step': 2500, 'value': 19.050917907862836}
step_time: {'step': 2500, 'value': 0.03115120220184326}
env0_in_acc: {'step': 2500, 'value': 0.9858490566037735}
env0_in_max_difference: {'step': 2500, 'value': 1.0}
env0_in_demographic_parity: {'step': 2500, 'value': 0}
env0_in_equalized_odds: {'step': 2500, 'value': 0}
env0_in_auc_score: {'step': 2500, 'value': 0.5}
env1_in_acc: {'step': 2500, 'value': 0.9991341991341991}
env1_in_max_difference: {'step': 2500, 'value': 1.0}
env1_in_demographic_parity: {'step': 2500, 'value': 0}
env1_in_equalized_odds: {'step': 2500, 'value': 0}
env1_in_auc_score: {'step': 2500, 'value': 0.5}
env0_out_acc: {'step': 2500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2500, 'value': 1.0}
env0_out_demographic_parity: {'step': 2500, 'value': 0}
env0_out_equalized_odds: {'step': 2500, 'value': 0}
env0_out_auc_score: {'step': 2500, 'value': 0.5}
env1_out_acc: {'step': 2500, 'value': 0.9809358752166378}
env1_out_max_difference: {'step': 2500, 'value': 1.0}
env1_out_demographic_parity: {'step': 2500, 'value': 0}
env1_out_equalized_odds: {'step': 2500, 'value': 0.0}
env1_out_auc_score: {'step': 2500, 'value': 0.0}
------------------------------

Training simulation completed!
==================================================
Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders

Checking class distribution in evaluation data:

Split 0 (in):
Total samples: 424
Class distribution:
  Class 0: 420 samples (99.1%)
  Class 1: 4 samples (0.9%)

Split 1 (in):
Total samples: 2310
Class distribution:
  Class 0: 2262 samples (97.9%)
  Class 1: 48 samples (2.1%)

Split 2 (out):
Total samples: 105
Class distribution:
  Class 0: 104 samples (99.0%)
  Class 1: 1 samples (1.0%)

Split 3 (out):
Total samples: 577
Class distribution:
  Class 0: 567 samples (98.3%)
  Class 1: 10 samples (1.7%)

Evaluation loader names: ['env0_in', 'env1_in', 'env0_out', 'env1_out']
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard

Starting webapp training loop simulation...
Will evaluate every None steps
==================================================
Starting training thread...
[2025-04-27 19:48:17] 
Starting training loop...
[2025-04-27 19:48:17] ==================================================
[2025-04-27 19:48:17] Total steps per epoch: 131.22727272727272
[2025-04-27 19:48:17] Target epochs: Not specified
[2025-04-27 19:48:17] ==================================================

Metrics Update:
------------------------------
------------------------------
[2025-04-27 19:48:34] 
Step 500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0101
l_cls               : 0.0101
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:48:46] 
Evaluation at step 501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0327 (mean)
loss                : 0.1103 (mean)
l_cls               : 0.1103 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 382.66 MB
Final allocation   : 383.24 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 500.0000
epoch               : 3.8102
step_time           : 0.0327
loss                : 0.1103
l_cls               : 0.1103
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03272466039657593, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03272466039657593, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 500, 'value': 0.11032169118573074}
l_cls: {'step': 500, 'value': 0.11032169118573074}
step: {'step': 500, 'value': 500}
epoch: {'step': 500, 'value': 3.810183581572567}
step_time: {'step': 500, 'value': 0.03272466039657593}
env0_in_acc: {'step': 500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 500, 'value': 1.0}
env0_in_demographic_parity: {'step': 500, 'value': 0}
env0_in_equalized_odds: {'step': 500, 'value': 0}
env0_in_auc_score: {'step': 500, 'value': 0.5}
env1_in_acc: {'step': 500, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 500, 'value': 1.0}
env1_in_demographic_parity: {'step': 500, 'value': 0}
env1_in_equalized_odds: {'step': 500, 'value': 0}
env1_in_auc_score: {'step': 500, 'value': 0.5}
env0_out_acc: {'step': 500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 500, 'value': 1.0}
env0_out_demographic_parity: {'step': 500, 'value': 0}
env0_out_equalized_odds: {'step': 500, 'value': 0}
env0_out_auc_score: {'step': 500, 'value': 0.5}
env1_out_acc: {'step': 500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 500, 'value': 1.0}
env1_out_demographic_parity: {'step': 500, 'value': 0}
env1_out_equalized_odds: {'step': 500, 'value': 0}
env1_out_auc_score: {'step': 500, 'value': 0.5}
------------------------------
[2025-04-27 19:49:01] 
Step 1000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1904
l_cls               : 0.1904
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:49:13] 
Evaluation at step 1001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0978 (mean)
l_cls               : 0.0978 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.41 MB
Final allocation   : 380.99 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1000.0000
epoch               : 7.6204
step_time           : 0.0311
loss                : 0.0978
l_cls               : 0.0978
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.031069859504699707, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.031069859504699707, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1000, 'value': 0.09776811206387356}
l_cls: {'step': 1000, 'value': 0.09776811206387356}
step: {'step': 1000, 'value': 1000}
epoch: {'step': 1000, 'value': 7.620367163145134}
step_time: {'step': 1000, 'value': 0.031069859504699707}
env0_in_acc: {'step': 1000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1000, 'value': 1.0}
env0_in_demographic_parity: {'step': 1000, 'value': 0}
env0_in_equalized_odds: {'step': 1000, 'value': 0}
env0_in_auc_score: {'step': 1000, 'value': 0.5}
env1_in_acc: {'step': 1000, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 1000, 'value': 1.0}
env1_in_demographic_parity: {'step': 1000, 'value': 0}
env1_in_equalized_odds: {'step': 1000, 'value': 0}
env1_in_auc_score: {'step': 1000, 'value': 0.5}
env0_out_acc: {'step': 1000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1000, 'value': 1.0}
env0_out_demographic_parity: {'step': 1000, 'value': 0}
env0_out_equalized_odds: {'step': 1000, 'value': 0}
env0_out_auc_score: {'step': 1000, 'value': 0.5}
env1_out_acc: {'step': 1000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1000, 'value': 1.0}
env1_out_demographic_parity: {'step': 1000, 'value': 0}
env1_out_equalized_odds: {'step': 1000, 'value': 0}
env1_out_auc_score: {'step': 1000, 'value': 0.5}
------------------------------
[2025-04-27 19:49:28] 
Step 1500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0098
l_cls               : 0.0098
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:49:40] 
Evaluation at step 1501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0852 (mean)
l_cls               : 0.0852 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9840
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.90 MB
Final allocation   : 381.47 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1500.0000
epoch               : 11.4306
step_time           : 0.0311
loss                : 0.0852
l_cls               : 0.0852
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9840
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.03113727569580078, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.03113727569580078, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1500, 'value': 0.08522867177985609}
l_cls: {'step': 1500, 'value': 0.08522867177985609}
step: {'step': 1500, 'value': 1500}
epoch: {'step': 1500, 'value': 11.430550744717701}
step_time: {'step': 1500, 'value': 0.03113727569580078}
env0_in_acc: {'step': 1500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1500, 'value': 1.0}
env0_in_demographic_parity: {'step': 1500, 'value': 0}
env0_in_equalized_odds: {'step': 1500, 'value': 0}
env0_in_auc_score: {'step': 1500, 'value': 0.5}
env1_in_acc: {'step': 1500, 'value': 0.983982683982684}
env1_in_max_difference: {'step': 1500, 'value': 1.0}
env1_in_demographic_parity: {'step': 1500, 'value': 0}
env1_in_equalized_odds: {'step': 1500, 'value': 0}
env1_in_auc_score: {'step': 1500, 'value': 0.5}
env0_out_acc: {'step': 1500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1500, 'value': 1.0}
env0_out_demographic_parity: {'step': 1500, 'value': 0}
env0_out_equalized_odds: {'step': 1500, 'value': 0}
env0_out_auc_score: {'step': 1500, 'value': 0.5}
env1_out_acc: {'step': 1500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1500, 'value': 1.0}
env1_out_demographic_parity: {'step': 1500, 'value': 0}
env1_out_equalized_odds: {'step': 1500, 'value': 0}
env1_out_auc_score: {'step': 1500, 'value': 0.5}
------------------------------
[2025-04-27 19:49:55] 
Step 2000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1705
l_cls               : 0.1705
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:50:07] 
Evaluation at step 2001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0753 (mean)
l_cls               : 0.0753 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9801
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2000.0000
epoch               : 15.2407
step_time           : 0.0311
loss                : 0.0753
l_cls               : 0.0753
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9801
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.03109779644012451, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.03109779644012451, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 2000, 'value': 0.07532603965706584}
l_cls: {'step': 2000, 'value': 0.07532603965706584}
step: {'step': 2000, 'value': 2000}
epoch: {'step': 2000, 'value': 15.240734326290267}
step_time: {'step': 2000, 'value': 0.03109779644012451}
env0_in_acc: {'step': 2000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 2000, 'value': 1.0}
env0_in_demographic_parity: {'step': 2000, 'value': 0}
env0_in_equalized_odds: {'step': 2000, 'value': 0}
env0_in_auc_score: {'step': 2000, 'value': 0.5}
env1_in_acc: {'step': 2000, 'value': 0.9800865800865801}
env1_in_max_difference: {'step': 2000, 'value': 1.0}
env1_in_demographic_parity: {'step': 2000, 'value': 0}
env1_in_equalized_odds: {'step': 2000, 'value': 0}
env1_in_auc_score: {'step': 2000, 'value': 0.5}
env0_out_acc: {'step': 2000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2000, 'value': 1.0}
env0_out_demographic_parity: {'step': 2000, 'value': 0}
env0_out_equalized_odds: {'step': 2000, 'value': 0}
env0_out_auc_score: {'step': 2000, 'value': 0.5}
env1_out_acc: {'step': 2000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 2000, 'value': 1.0}
env1_out_demographic_parity: {'step': 2000, 'value': 0}
env1_out_equalized_odds: {'step': 2000, 'value': 0}
env1_out_auc_score: {'step': 2000, 'value': 0.5}
------------------------------
[2025-04-27 19:50:23] 
Step 2500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0002
l_cls               : 0.0002
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:50:34] 
Evaluation at step 2501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0312 (mean)
loss                : 0.0169 (mean)
l_cls               : 0.0169 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9858
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9991
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9809
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2500.0000
epoch               : 19.0509
step_time           : 0.0312
loss                : 0.0169
l_cls               : 0.0169
env0_in_acc         : 0.9858
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9991
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9809
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.03117046308517456, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.03117046308517456, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 2500, 'value': 0.016926033473597585}
l_cls: {'step': 2500, 'value': 0.016926033473597585}
step: {'step': 2500, 'value': 2500}
epoch: {'step': 2500, 'value': 19.050917907862836}
step_time: {'step': 2500, 'value': 0.03117046308517456}
env0_in_acc: {'step': 2500, 'value': 0.9858490566037735}
env0_in_max_difference: {'step': 2500, 'value': 1.0}
env0_in_demographic_parity: {'step': 2500, 'value': 0}
env0_in_equalized_odds: {'step': 2500, 'value': 0}
env0_in_auc_score: {'step': 2500, 'value': 0.5}
env1_in_acc: {'step': 2500, 'value': 0.9991341991341991}
env1_in_max_difference: {'step': 2500, 'value': 1.0}
env1_in_demographic_parity: {'step': 2500, 'value': 0}
env1_in_equalized_odds: {'step': 2500, 'value': 0}
env1_in_auc_score: {'step': 2500, 'value': 0.5}
env0_out_acc: {'step': 2500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2500, 'value': 1.0}
env0_out_demographic_parity: {'step': 2500, 'value': 0}
env0_out_equalized_odds: {'step': 2500, 'value': 0}
env0_out_auc_score: {'step': 2500, 'value': 0.5}
env1_out_acc: {'step': 2500, 'value': 0.9809358752166378}
env1_out_max_difference: {'step': 2500, 'value': 1.0}
env1_out_demographic_parity: {'step': 2500, 'value': 0}
env1_out_equalized_odds: {'step': 2500, 'value': 0}
env1_out_auc_score: {'step': 2500, 'value': 0.5}
------------------------------
[2025-04-27 19:50:50] 
Step 3000:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:51:01] 
Evaluation at step 3001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0312 (mean)
loss                : 0.0041 (mean)
l_cls               : 0.0041 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 3000.0000
epoch               : 22.8611
step_time           : 0.0312
loss                : 0.0041
l_cls               : 0.0041
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 3000: {'step': 3000, 'epoch': 22.861101489435402, 'step_time': 0.03116868782043457, 'loss': 0.004140488821261357, 'l_cls': 0.004140488821261357, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 3000: {'step': 3000, 'epoch': 22.861101489435402, 'step_time': 0.03116868782043457, 'loss': 0.004140488821261357, 'l_cls': 0.004140488821261357, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 3000, 'value': 0.004140488821261357}
l_cls: {'step': 3000, 'value': 0.004140488821261357}
step: {'step': 3000, 'value': 3000}
epoch: {'step': 3000, 'value': 22.861101489435402}
step_time: {'step': 3000, 'value': 0.03116868782043457}
env0_in_acc: {'step': 3000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 3000, 'value': 1.0}
env0_in_demographic_parity: {'step': 3000, 'value': 0}
env0_in_equalized_odds: {'step': 3000, 'value': 0}
env0_in_auc_score: {'step': 3000, 'value': 0.5}
env1_in_acc: {'step': 3000, 'value': 1.0}
env1_in_max_difference: {'step': 3000, 'value': 1.0}
env1_in_demographic_parity: {'step': 3000, 'value': 0}
env1_in_equalized_odds: {'step': 3000, 'value': 0}
env1_in_auc_score: {'step': 3000, 'value': 0.5}
env0_out_acc: {'step': 3000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 3000, 'value': 1.0}
env0_out_demographic_parity: {'step': 3000, 'value': 0}
env0_out_equalized_odds: {'step': 3000, 'value': 0}
env0_out_auc_score: {'step': 3000, 'value': 0.5}
env1_out_acc: {'step': 3000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 3000, 'value': 1.0}
env1_out_demographic_parity: {'step': 3000, 'value': 0}
env1_out_equalized_odds: {'step': 3000, 'value': 0}
env1_out_auc_score: {'step': 3000, 'value': 0.5}
------------------------------
[2025-04-27 19:51:17] 
Step 3500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:51:29] 
Evaluation at step 3501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 3500.0000
epoch               : 26.6713
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 3500: {'step': 3500, 'epoch': 26.67128507100797, 'step_time': 0.031091108798980714, 'loss': 1.592333407312907e-05, 'l_cls': 1.592333407312907e-05, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 3500: {'step': 3500, 'epoch': 26.67128507100797, 'step_time': 0.031091108798980714, 'loss': 1.592333407312907e-05, 'l_cls': 1.592333407312907e-05, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 3500, 'value': 1.592333407312907e-05}
l_cls: {'step': 3500, 'value': 1.592333407312907e-05}
step: {'step': 3500, 'value': 3500}
epoch: {'step': 3500, 'value': 26.67128507100797}
step_time: {'step': 3500, 'value': 0.031091108798980714}
env0_in_acc: {'step': 3500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 3500, 'value': 1.0}
env0_in_demographic_parity: {'step': 3500, 'value': 0}
env0_in_equalized_odds: {'step': 3500, 'value': 0}
env0_in_auc_score: {'step': 3500, 'value': 0.5}
env1_in_acc: {'step': 3500, 'value': 1.0}
env1_in_max_difference: {'step': 3500, 'value': 1.0}
env1_in_demographic_parity: {'step': 3500, 'value': 0}
env1_in_equalized_odds: {'step': 3500, 'value': 0}
env1_in_auc_score: {'step': 3500, 'value': 0.5}
env0_out_acc: {'step': 3500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 3500, 'value': 1.0}
env0_out_demographic_parity: {'step': 3500, 'value': 0}
env0_out_equalized_odds: {'step': 3500, 'value': 0}
env0_out_auc_score: {'step': 3500, 'value': 0.5}
env1_out_acc: {'step': 3500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 3500, 'value': 1.0}
env1_out_demographic_parity: {'step': 3500, 'value': 0}
env1_out_equalized_odds: {'step': 3500, 'value': 0}
env1_out_auc_score: {'step': 3500, 'value': 0.5}
------------------------------
[2025-04-27 19:51:44] 
Step 4000:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:51:56] 
Evaluation at step 4001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 4000.0000
epoch               : 30.4815
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 4000: {'step': 4000, 'epoch': 30.481468652580535, 'step_time': 0.031087627410888673, 'loss': 4.853858316134385e-06, 'l_cls': 4.853858316134385e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 4000: {'step': 4000, 'epoch': 30.481468652580535, 'step_time': 0.031087627410888673, 'loss': 4.853858316134385e-06, 'l_cls': 4.853858316134385e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 4000, 'value': 4.853858316134385e-06}
l_cls: {'step': 4000, 'value': 4.853858316134385e-06}
step: {'step': 4000, 'value': 4000}
epoch: {'step': 4000, 'value': 30.481468652580535}
step_time: {'step': 4000, 'value': 0.031087627410888673}
env0_in_acc: {'step': 4000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 4000, 'value': 1.0}
env0_in_demographic_parity: {'step': 4000, 'value': 0}
env0_in_equalized_odds: {'step': 4000, 'value': 0}
env0_in_auc_score: {'step': 4000, 'value': 0.5}
env1_in_acc: {'step': 4000, 'value': 1.0}
env1_in_max_difference: {'step': 4000, 'value': 1.0}
env1_in_demographic_parity: {'step': 4000, 'value': 0}
env1_in_equalized_odds: {'step': 4000, 'value': 0}
env1_in_auc_score: {'step': 4000, 'value': 0.5}
env0_out_acc: {'step': 4000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 4000, 'value': 1.0}
env0_out_demographic_parity: {'step': 4000, 'value': 0}
env0_out_equalized_odds: {'step': 4000, 'value': 0}
env0_out_auc_score: {'step': 4000, 'value': 0.5}
env1_out_acc: {'step': 4000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 4000, 'value': 1.0}
env1_out_demographic_parity: {'step': 4000, 'value': 0}
env1_out_equalized_odds: {'step': 4000, 'value': 0}
env1_out_auc_score: {'step': 4000, 'value': 0.5}
------------------------------
[2025-04-27 19:52:11] 
Step 4500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:52:23] 
Evaluation at step 4501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 4500.0000
epoch               : 34.2917
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 4500: {'step': 4500, 'epoch': 34.291652234153105, 'step_time': 0.031087997436523438, 'loss': 2.705674614656317e-06, 'l_cls': 2.705674614656317e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 4500: {'step': 4500, 'epoch': 34.291652234153105, 'step_time': 0.031087997436523438, 'loss': 2.705674614656317e-06, 'l_cls': 2.705674614656317e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 4500, 'value': 2.705674614656317e-06}
l_cls: {'step': 4500, 'value': 2.705674614656317e-06}
step: {'step': 4500, 'value': 4500}
epoch: {'step': 4500, 'value': 34.291652234153105}
step_time: {'step': 4500, 'value': 0.031087997436523438}
env0_in_acc: {'step': 4500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 4500, 'value': 1.0}
env0_in_demographic_parity: {'step': 4500, 'value': 0}
env0_in_equalized_odds: {'step': 4500, 'value': 0}
env0_in_auc_score: {'step': 4500, 'value': 0.5}
env1_in_acc: {'step': 4500, 'value': 1.0}
env1_in_max_difference: {'step': 4500, 'value': 1.0}
env1_in_demographic_parity: {'step': 4500, 'value': 0}
env1_in_equalized_odds: {'step': 4500, 'value': 0}
env1_in_auc_score: {'step': 4500, 'value': 0.5}
env0_out_acc: {'step': 4500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 4500, 'value': 1.0}
env0_out_demographic_parity: {'step': 4500, 'value': 0}
env0_out_equalized_odds: {'step': 4500, 'value': 0}
env0_out_auc_score: {'step': 4500, 'value': 0.5}
env1_out_acc: {'step': 4500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 4500, 'value': 1.0}
env1_out_demographic_parity: {'step': 4500, 'value': 0}
env1_out_equalized_odds: {'step': 4500, 'value': 0}
env1_out_auc_score: {'step': 4500, 'value': 0.5}
------------------------------
[2025-04-27 19:52:39] 
Step 5000:
==================================================
Training Metrics:
------------------------------
loss                : 0.0000
l_cls               : 0.0000
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:52:50] 
Evaluation at step 5001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0000 (mean)
l_cls               : 0.0000 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 1.0000
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.99 MB
Final allocation   : 381.57 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 5000.0000
epoch               : 38.1018
step_time           : 0.0311
loss                : 0.0000
l_cls               : 0.0000
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 1.0000
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 5000: {'step': 5000, 'epoch': 38.10183581572567, 'step_time': 0.03106027841567993, 'loss': 1.7259902275537087e-06, 'l_cls': 1.7259902275537087e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 5000: {'step': 5000, 'epoch': 38.10183581572567, 'step_time': 0.03106027841567993, 'loss': 1.7259902275537087e-06, 'l_cls': 1.7259902275537087e-06, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 1.0, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 5000, 'value': 1.7259902275537087e-06}
l_cls: {'step': 5000, 'value': 1.7259902275537087e-06}
step: {'step': 5000, 'value': 5000}
epoch: {'step': 5000, 'value': 38.10183581572567}
step_time: {'step': 5000, 'value': 0.03106027841567993}
env0_in_acc: {'step': 5000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 5000, 'value': 1.0}
env0_in_demographic_parity: {'step': 5000, 'value': 0}
env0_in_equalized_odds: {'step': 5000, 'value': 0}
env0_in_auc_score: {'step': 5000, 'value': 0.5}
env1_in_acc: {'step': 5000, 'value': 1.0}
env1_in_max_difference: {'step': 5000, 'value': 1.0}
env1_in_demographic_parity: {'step': 5000, 'value': 0}
env1_in_equalized_odds: {'step': 5000, 'value': 0}
env1_in_auc_score: {'step': 5000, 'value': 0.5}
env0_out_acc: {'step': 5000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 5000, 'value': 1.0}
env0_out_demographic_parity: {'step': 5000, 'value': 0}
env0_out_equalized_odds: {'step': 5000, 'value': 0}
env0_out_auc_score: {'step': 5000, 'value': 0.5}
env1_out_acc: {'step': 5000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 5000, 'value': 1.0}
env1_out_demographic_parity: {'step': 5000, 'value': 0}
env1_out_equalized_odds: {'step': 5000, 'value': 0}
env1_out_auc_score: {'step': 5000, 'value': 0.5}
------------------------------

Keyboard interrupt received. Stopping training...

Shutting down training manager...
Shutting down training manager...

Training simulation completed!
==================================================
Environment:
	Python: 3.8.15
	PyTorch: 2.4.1+cu121
	Torchvision: 0.19.1+cu121
	CUDA: 12.1
	CUDNN: 90100
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: ./domainbed/data/
	dataset: BDDPerson
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: debug_webapp_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	step: 2
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
	webapp_mode: True
HParams:
	batch_size: 22
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0

Debugging dataset splitting:
Dataset type: <class 'domainbed.datasets.BDDPerson'>
Number of environments: 2
Test environments: [0]
Holdout fraction: 0.2

Processing environment 0:
Environment size: 529
Split sizes - in: 424, out: 105
Test env split - in: 424, uda: 0

Processing environment 1:
Environment size: 2887
Split sizes - in: 2310, out: 577

Final split sizes:
In splits: [424, 2310]
Out splits: [105, 577]
UDA splits: []

Creating data loaders:
Created 1 training loaders
Created 0 UDA loaders

Checking class distribution in evaluation data:

Split 0 (in):
Total samples: 424
Class distribution:
  Class 0: 420 samples (99.1%)
  Class 1: 4 samples (0.9%)

Split 1 (in):
Total samples: 2310
Class distribution:
  Class 0: 2262 samples (97.9%)
  Class 1: 48 samples (2.1%)

Split 2 (out):
Total samples: 105
Class distribution:
  Class 0: 104 samples (99.0%)
  Class 1: 1 samples (1.0%)

Split 3 (out):
Total samples: 577
Class distribution:
  Class 0: 567 samples (98.3%)
  Class 1: 10 samples (1.7%)

Evaluation loader names: ['env0_in', 'env1_in', 'env0_out', 'env1_out']
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard
Initializing TensorBoard writer at: debug_webapp_output/logs/tensorboard

Starting webapp training loop simulation...
Will evaluate every None steps
==================================================
Starting training thread...
[2025-04-27 19:56:10] 
Starting training loop...
[2025-04-27 19:56:10] ==================================================
[2025-04-27 19:56:10] Total steps per epoch: 131.22727272727272
[2025-04-27 19:56:10] Target epochs: Not specified
[2025-04-27 19:56:10] ==================================================

Metrics Update:
------------------------------
------------------------------
[2025-04-27 19:56:26] 
Step 500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0101
l_cls               : 0.0101
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:56:37] 
Evaluation at step 501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0318 (mean)
loss                : 0.1103 (mean)
l_cls               : 0.1103 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 382.66 MB
Final allocation   : 383.24 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 500.0000
epoch               : 3.8102
step_time           : 0.0318
loss                : 0.1103
l_cls               : 0.1103
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03182177639007568, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 500: {'step': 500, 'epoch': 3.810183581572567, 'step_time': 0.03182177639007568, 'loss': 0.11032169118573074, 'l_cls': 0.11032169118573074, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 500, 'value': 0.11032169118573074}
l_cls: {'step': 500, 'value': 0.11032169118573074}
step: {'step': 500, 'value': 500}
epoch: {'step': 500, 'value': 3.810183581572567}
step_time: {'step': 500, 'value': 0.03182177639007568}
env0_in_acc: {'step': 500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 500, 'value': 1.0}
env0_in_demographic_parity: {'step': 500, 'value': 0}
env0_in_equalized_odds: {'step': 500, 'value': 0}
env0_in_auc_score: {'step': 500, 'value': 0.5}
env1_in_acc: {'step': 500, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 500, 'value': 1.0}
env1_in_demographic_parity: {'step': 500, 'value': 0}
env1_in_equalized_odds: {'step': 500, 'value': 0}
env1_in_auc_score: {'step': 500, 'value': 0.5}
env0_out_acc: {'step': 500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 500, 'value': 1.0}
env0_out_demographic_parity: {'step': 500, 'value': 0}
env0_out_equalized_odds: {'step': 500, 'value': 0}
env0_out_auc_score: {'step': 500, 'value': 0.5}
env1_out_acc: {'step': 500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 500, 'value': 1.0}
env1_out_demographic_parity: {'step': 500, 'value': 0}
env1_out_equalized_odds: {'step': 500, 'value': 0}
env1_out_auc_score: {'step': 500, 'value': 0.5}
------------------------------
[2025-04-27 19:56:53] 
Step 1000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1904
l_cls               : 0.1904
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:57:04] 
Evaluation at step 1001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0310 (mean)
loss                : 0.0978 (mean)
l_cls               : 0.0978 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9792
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.20 MB
Final allocation   : 380.78 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1000.0000
epoch               : 7.6204
step_time           : 0.0310
loss                : 0.0978
l_cls               : 0.0978
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9792
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.030958964824676513, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1000: {'step': 1000, 'epoch': 7.620367163145134, 'step_time': 0.030958964824676513, 'loss': 0.09776811206387356, 'l_cls': 0.09776811206387356, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9792207792207792, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1000, 'value': 0.09776811206387356}
l_cls: {'step': 1000, 'value': 0.09776811206387356}
step: {'step': 1000, 'value': 1000}
epoch: {'step': 1000, 'value': 7.620367163145134}
step_time: {'step': 1000, 'value': 0.030958964824676513}
env0_in_acc: {'step': 1000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1000, 'value': 1.0}
env0_in_demographic_parity: {'step': 1000, 'value': 0}
env0_in_equalized_odds: {'step': 1000, 'value': 0}
env0_in_auc_score: {'step': 1000, 'value': 0.5}
env1_in_acc: {'step': 1000, 'value': 0.9792207792207792}
env1_in_max_difference: {'step': 1000, 'value': 1.0}
env1_in_demographic_parity: {'step': 1000, 'value': 0}
env1_in_equalized_odds: {'step': 1000, 'value': 0}
env1_in_auc_score: {'step': 1000, 'value': 0.5}
env0_out_acc: {'step': 1000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1000, 'value': 1.0}
env0_out_demographic_parity: {'step': 1000, 'value': 0}
env0_out_equalized_odds: {'step': 1000, 'value': 0}
env0_out_auc_score: {'step': 1000, 'value': 0.5}
env1_out_acc: {'step': 1000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1000, 'value': 1.0}
env1_out_demographic_parity: {'step': 1000, 'value': 0}
env1_out_equalized_odds: {'step': 1000, 'value': 0}
env1_out_auc_score: {'step': 1000, 'value': 0.5}
------------------------------
[2025-04-27 19:57:20] 
Step 1500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0098
l_cls               : 0.0098
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:57:32] 
Evaluation at step 1501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0312 (mean)
loss                : 0.0852 (mean)
l_cls               : 0.0852 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9840
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.63 MB
Final allocation   : 381.21 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 1500.0000
epoch               : 11.4306
step_time           : 0.0312
loss                : 0.0852
l_cls               : 0.0852
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9840
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.031179798126220702, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 1500: {'step': 1500, 'epoch': 11.430550744717701, 'step_time': 0.031179798126220702, 'loss': 0.08522867177985609, 'l_cls': 0.08522867177985609, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.983982683982684, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 1500, 'value': 0.08522867177985609}
l_cls: {'step': 1500, 'value': 0.08522867177985609}
step: {'step': 1500, 'value': 1500}
epoch: {'step': 1500, 'value': 11.430550744717701}
step_time: {'step': 1500, 'value': 0.031179798126220702}
env0_in_acc: {'step': 1500, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 1500, 'value': 1.0}
env0_in_demographic_parity: {'step': 1500, 'value': 0}
env0_in_equalized_odds: {'step': 1500, 'value': 0}
env0_in_auc_score: {'step': 1500, 'value': 0.5}
env1_in_acc: {'step': 1500, 'value': 0.983982683982684}
env1_in_max_difference: {'step': 1500, 'value': 1.0}
env1_in_demographic_parity: {'step': 1500, 'value': 0}
env1_in_equalized_odds: {'step': 1500, 'value': 0}
env1_in_auc_score: {'step': 1500, 'value': 0.5}
env0_out_acc: {'step': 1500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 1500, 'value': 1.0}
env0_out_demographic_parity: {'step': 1500, 'value': 0}
env0_out_equalized_odds: {'step': 1500, 'value': 0}
env0_out_auc_score: {'step': 1500, 'value': 0.5}
env1_out_acc: {'step': 1500, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 1500, 'value': 1.0}
env1_out_demographic_parity: {'step': 1500, 'value': 0}
env1_out_equalized_odds: {'step': 1500, 'value': 0}
env1_out_auc_score: {'step': 1500, 'value': 0.5}
------------------------------
[2025-04-27 19:57:47] 
Step 2000:
==================================================
Training Metrics:
------------------------------
loss                : 0.1705
l_cls               : 0.1705
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:57:59] 
Evaluation at step 2001:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0311 (mean)
loss                : 0.0753 (mean)
l_cls               : 0.0753 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9906
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9801
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9827
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.63 MB
Final allocation   : 381.21 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2000.0000
epoch               : 15.2407
step_time           : 0.0311
loss                : 0.0753
l_cls               : 0.0753
env0_in_acc         : 0.9906
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9801
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9827
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.031068625450134276, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 2000: {'step': 2000, 'epoch': 15.240734326290267, 'step_time': 0.031068625450134276, 'loss': 0.07532603965706584, 'l_cls': 0.07532603965706584, 'env0_in_acc': 0.9905660377358491, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9800865800865801, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9826689774696707, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 2000, 'value': 0.07532603965706584}
l_cls: {'step': 2000, 'value': 0.07532603965706584}
step: {'step': 2000, 'value': 2000}
epoch: {'step': 2000, 'value': 15.240734326290267}
step_time: {'step': 2000, 'value': 0.031068625450134276}
env0_in_acc: {'step': 2000, 'value': 0.9905660377358491}
env0_in_max_difference: {'step': 2000, 'value': 1.0}
env0_in_demographic_parity: {'step': 2000, 'value': 0}
env0_in_equalized_odds: {'step': 2000, 'value': 0}
env0_in_auc_score: {'step': 2000, 'value': 0.5}
env1_in_acc: {'step': 2000, 'value': 0.9800865800865801}
env1_in_max_difference: {'step': 2000, 'value': 1.0}
env1_in_demographic_parity: {'step': 2000, 'value': 0}
env1_in_equalized_odds: {'step': 2000, 'value': 0}
env1_in_auc_score: {'step': 2000, 'value': 0.5}
env0_out_acc: {'step': 2000, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2000, 'value': 1.0}
env0_out_demographic_parity: {'step': 2000, 'value': 0}
env0_out_equalized_odds: {'step': 2000, 'value': 0}
env0_out_auc_score: {'step': 2000, 'value': 0.5}
env1_out_acc: {'step': 2000, 'value': 0.9826689774696707}
env1_out_max_difference: {'step': 2000, 'value': 1.0}
env1_out_demographic_parity: {'step': 2000, 'value': 0}
env1_out_equalized_odds: {'step': 2000, 'value': 0}
env1_out_auc_score: {'step': 2000, 'value': 0.5}
------------------------------
[2025-04-27 19:58:15] 
Step 2500:
==================================================
Training Metrics:
------------------------------
loss                : 0.0002
l_cls               : 0.0002
Step time: 0.03s
==================================================

Loader 0 (env0_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_in...

Loader 1 (env1_in):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_in...

Loader 2 (env0_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env0_out...

Loader 3 (env1_out):
Loader type: <class 'domainbed.lib.fast_data_loader.FastDataLoader'>

Attempting to load first batch from env1_out...
[2025-04-27 19:58:26] 
Evaluation at step 2501:
==================================================

Checkpoint Values:
------------------------------
step_time           : 0.0310 (mean)
loss                : 0.0169 (mean)
l_cls               : 0.0169 (mean)

env0_in Results:
------------------------------

Data Statistics for env0_in:
Total samples: 424
accuracy          : 0.9858
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_in Results:
------------------------------

Data Statistics for env1_in:
Total samples: 2310
accuracy          : 0.9991
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env0_out Results:
------------------------------

Data Statistics for env0_out:
Total samples: 105
accuracy          : 0.9905
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

env1_out Results:
------------------------------

Data Statistics for env1_out:
Total samples: 577
accuracy          : 0.9809
max_difference      : 1.0000
demographic_parity  : 0.0000
equalized_odds      : 0.0000
auc_score           : 0.5000

GPU Memory Statistics:
Initial allocation : 380.63 MB
Final allocation   : 381.21 MB
Memory difference : 0.58 MB

All Metrics Summary:
------------------------------
step                : 2500.0000
epoch               : 19.0509
step_time           : 0.0310
loss                : 0.0169
l_cls               : 0.0169
env0_in_acc         : 0.9858
env0_in_max_difference: 1.0000
env0_in_demographic_parity: 0.0000
env0_in_equalized_odds: 0.0000
env0_in_auc_score   : 0.5000
env1_in_acc         : 0.9991
env1_in_max_difference: 1.0000
env1_in_demographic_parity: 0.0000
env1_in_equalized_odds: 0.0000
env1_in_auc_score   : 0.5000
env0_out_acc        : 0.9905
env0_out_max_difference: 1.0000
env0_out_demographic_parity: 0.0000
env0_out_equalized_odds: 0.0000
env0_out_auc_score  : 0.5000
env1_out_acc        : 0.9809
env1_out_max_difference: 1.0000
env1_out_demographic_parity: 0.0000
env1_out_equalized_odds: 0.0000
env1_out_auc_score  : 0.5000
==================================================
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.031037941932678222, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}
Results at step 2500: {'step': 2500, 'epoch': 19.050917907862836, 'step_time': 0.031037941932678222, 'loss': 0.016926033473597585, 'l_cls': 0.016926033473597585, 'env0_in_acc': 0.9858490566037735, 'env0_in_max_difference': 1.0, 'env0_in_demographic_parity': 0, 'env0_in_equalized_odds': 0, 'env0_in_auc_score': 0.5, 'env1_in_acc': 0.9991341991341991, 'env1_in_max_difference': 1.0, 'env1_in_demographic_parity': 0, 'env1_in_equalized_odds': 0, 'env1_in_auc_score': 0.5, 'env0_out_acc': 0.9904761904761905, 'env0_out_max_difference': 1.0, 'env0_out_demographic_parity': 0, 'env0_out_equalized_odds': 0, 'env0_out_auc_score': 0.5, 'env1_out_acc': 0.9809358752166378, 'env1_out_max_difference': 1.0, 'env1_out_demographic_parity': 0, 'env1_out_equalized_odds': 0, 'env1_out_auc_score': 0.5}

Metrics Update:
------------------------------
loss: {'step': 2500, 'value': 0.016926033473597585}
l_cls: {'step': 2500, 'value': 0.016926033473597585}
step: {'step': 2500, 'value': 2500}
epoch: {'step': 2500, 'value': 19.050917907862836}
step_time: {'step': 2500, 'value': 0.031037941932678222}
env0_in_acc: {'step': 2500, 'value': 0.9858490566037735}
env0_in_max_difference: {'step': 2500, 'value': 1.0}
env0_in_demographic_parity: {'step': 2500, 'value': 0}
env0_in_equalized_odds: {'step': 2500, 'value': 0}
env0_in_auc_score: {'step': 2500, 'value': 0.5}
env1_in_acc: {'step': 2500, 'value': 0.9991341991341991}
env1_in_max_difference: {'step': 2500, 'value': 1.0}
env1_in_demographic_parity: {'step': 2500, 'value': 0}
env1_in_equalized_odds: {'step': 2500, 'value': 0}
env1_in_auc_score: {'step': 2500, 'value': 0.5}
env0_out_acc: {'step': 2500, 'value': 0.9904761904761905}
env0_out_max_difference: {'step': 2500, 'value': 1.0}
env0_out_demographic_parity: {'step': 2500, 'value': 0}
env0_out_equalized_odds: {'step': 2500, 'value': 0}
env0_out_auc_score: {'step': 2500, 'value': 0.5}
env1_out_acc: {'step': 2500, 'value': 0.9809358752166378}
env1_out_max_difference: {'step': 2500, 'value': 1.0}
env1_out_demographic_parity: {'step': 2500, 'value': 0}
env1_out_equalized_odds: {'step': 2500, 'value': 0}
env1_out_auc_score: {'step': 2500, 'value': 0.5}
------------------------------

Keyboard interrupt received. Stopping training...

Shutting down training manager...
Shutting down training manager...

Training simulation completed!
==================================================
