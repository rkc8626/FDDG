Traceback (most recent call last):
  File "debug_webapp_training.py", line 269, in <module>
    debug_webapp_training(args)
  File "debug_webapp_training.py", line 209, in debug_webapp_training
    training_manager = train_main(args)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 641, in main
    print("Evaluation loader datasets sizes:", [len(loader.dataset) for loader in eval_loaders])
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 641, in <listcomp>
    print("Evaluation loader datasets sizes:", [len(loader.dataset) for loader in eval_loaders])
AttributeError: 'FastDataLoader' object has no attribute 'dataset'
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/popen_fork.py", line 27, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 553870) is killed by signal: Terminated. 
Traceback (most recent call last):
  File "debug_webapp_training.py", line 279, in <module>
    debug_webapp_training(args)
  File "debug_webapp_training.py", line 219, in debug_webapp_training
    training_manager = train_main(args)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 641, in main
    print("Evaluation loader datasets sizes:", [len(loader._dataset) if hasattr(loader, '_dataset') else len(loader.dataset) for loader in eval_loaders])
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 641, in <listcomp>
    print("Evaluation loader datasets sizes:", [len(loader._dataset) if hasattr(loader, '_dataset') else len(loader.dataset) for loader in eval_loaders])
AttributeError: 'FastDataLoader' object has no attribute 'dataset'
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Exception in thread Thread-5:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 379, in webapp_training_loop
    results = self.evaluate()
  File "debug_webapp_training.py", line 89, in evaluate
    print(f"Dataset type: {type(loader._dataset) if hasattr(loader, '_dataset') else type(loader.dataset)}")
AttributeError: 'FastDataLoader' object has no attribute 'dataset'
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Exception in thread Thread-5:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 379, in webapp_training_loop
    results = self.evaluate()
  File "debug_webapp_training.py", line 91, in evaluate
    print(f"Batch size: {loader.batch_size}")
AttributeError: 'FastDataLoader' object has no attribute 'batch_size'
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Exception in thread Thread-5:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 379, in webapp_training_loop
    results = self.evaluate()
  File "debug_webapp_training.py", line 98, in evaluate
    for batch_idx, (x, y, z) in enumerate(loader):
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/lib/fast_data_loader.py", line 69, in __iter__
    yield next(self._infinite_iterator)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1293, in _get_data
    success, data = self._try_get_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 496, in rebuild_storage_fd
    fd = df.detach()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Exception in thread Thread-5:
Traceback (most recent call last):
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/scripts/train_with_panel.py", line 379, in webapp_training_loop
    results = self.evaluate()
  File "debug_webapp_training.py", line 98, in evaluate
    for batch_idx, (x, y, z) in enumerate(loader):
  File "/orange/ufdatastudios/chenz1/FDDG/fddg/domainbed/lib/fast_data_loader.py", line 69, in __iter__
    yield next(self._infinite_iterator)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1293, in _get_data
    success, data = self._try_get_data()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 496, in rebuild_storage_fd
    fd = df.detach()
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/blue/ufdatastudios/chenz1/.conda/envs/fddg2/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
